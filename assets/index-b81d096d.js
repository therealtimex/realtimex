import{j as e,i as U,r as s,b as v,G as y,S as m,s as f,e as N,f as S,ab as M,p as C}from"../index.js";import{S as E}from"./index-af9073a4.js";import{C as k}from"./index-07eec889.js";import"./Globe-1f44e45d.js";import"./index-0f62630d.js";import"./CaretRight-731d83f5.js";function R(){return e.jsxs("div",{className:"w-screen h-screen overflow-hidden bg-theme-bg-container flex",children:[e.jsx(E,{}),e.jsxs("div",{style:{height:U?"100%":"calc(100% - 32px)"},className:"relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0",children:[e.jsx(F,{}),e.jsx(I,{})]})]})}function F(){const[p,n]=s.useState(!1),[h,d]=s.useState(!1),[i,b]=s.useState(!1),[l,x]=s.useState(!1),[w,c]=s.useState(!0),{t}=v(),u=async a=>{if(a.preventDefault(),n(!0),d(!1),i){const r=new FormData(a.target),o={username:r.get("username"),password:r.get("password")},{success:g,error:j}=await m.setupMultiUser(o);if(g){f("Multi-User mode enabled successfully.","success"),n(!1),setTimeout(()=>{window.localStorage.removeItem(N),window.localStorage.removeItem(S),window.localStorage.removeItem(M),window.location=C.settings.users()},2e3);return}f(`Failed to enable Multi-User mode: ${j}`,"error"),n(!1);return}};return s.useEffect(()=>{async function a(){c(!0);const r=await m.isMultiUserMode();x(r),c(!1)}a()},[]),w?e.jsx("div",{className:"h-1/2 transition-all duration-500 relative md:ml-[2px] md:mr-[8px] md:my-[16px] md:rounded-[26px] p-[18px] h-full overflow-y-scroll",children:e.jsx("div",{className:"w-full h-full flex justify-center items-center",children:e.jsx(y,{})})}):e.jsx("form",{onSubmit:u,onChange:()=>d(!0),className:"flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16",children:e.jsxs("div",{className:"w-full flex flex-col gap-y-1 pb-6 border-white light:border-theme-sidebar-border border-b-2 border-opacity-10",children:[e.jsxs("div",{className:"w-full flex flex-col gap-y-1 border-white light:border-theme-sidebar-border border-b-2 border-opacity-10 pb-8",children:[e.jsx("div",{className:"items-center flex gap-x-4",children:e.jsx("p",{className:"text-lg leading-6 font-bold text-white",children:t("multi.title")})}),e.jsx("p",{className:"text-xs leading-[18px] font-base text-white text-opacity-60",children:t("multi.description")})]}),h&&e.jsx("div",{className:"flex justify-end",children:e.jsx(k,{onClick:()=>u(),className:"mt-3 mr-0 -mb-20 z-10",children:t(p?"common.saving":"common.save")})}),e.jsx("div",{className:"relative w-full max-h-full",children:e.jsxs("div",{className:"relative rounded-lg",children:[e.jsx("div",{className:"flex items-start justify-between px-6 py-4"}),e.jsx("div",{className:"space-y-6 flex h-full w-full",children:e.jsxs("div",{className:"w-full flex flex-col gap-y-4",children:[e.jsxs("div",{className:"",children:[e.jsx("label",{className:"mb-2.5 block font-medium text-white",children:t(l?"multi.enable.is-enable":"multi.enable.enable")}),e.jsxs("label",{className:"relative inline-flex cursor-pointer items-center",children:[e.jsx("input",{type:"checkbox",onClick:()=>b(!i),defaultChecked:i,className:"peer sr-only pointer-events-none"}),e.jsx("div",{hidden:l,className:"peer-disabled:opacity-50 pointer-events-none peer h-6 w-11 rounded-full bg-[#CFCFD0] after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:shadow-xl after:border-none after:bg-white after:box-shadow-md after:transition-all after:content-[''] peer-checked:bg-[#32D583] peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-transparent"})]})]}),i&&e.jsxs("div",{className:"w-full flex flex-col gap-y-2 my-5",children:[e.jsxs("div",{className:"w-80",children:[e.jsx("label",{htmlFor:"username",className:"block mb-3 font-medium text-white",children:t("multi.enable.username")}),e.jsx("input",{name:"username",type:"text",className:"border-none bg-theme-settings-input-bg text-white text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5 placeholder:text-theme-settings-input-placeholder focus:ring-blue-500",placeholder:"Your admin username",minLength:2,required:!0,autoComplete:"off",disabled:l,defaultValue:l?"********":""})]}),e.jsxs("div",{className:"mt-4 w-80",children:[e.jsx("label",{htmlFor:"password",className:"block mb-3 font-medium text-white",children:t("multi.enable.password")}),e.jsx("input",{name:"password",type:"text",className:"border-none bg-theme-settings-input-bg text-white text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5 placeholder:text-theme-settings-input-placeholder focus:ring-blue-500",placeholder:"Your admin password",minLength:8,required:!0,autoComplete:"off",defaultValue:l?"********":""})]})]})]})}),e.jsx("div",{className:"flex items-center justify-between space-x-14",children:e.jsx("p",{className:"text-white text-opacity-80 text-xs rounded-lg w-96",children:t("multi.enable.description")})})]})})]})})}const T=new RegExp(/^[a-zA-Z0-9_\-!@$%^&*();]+$/);function I(){const[p,n]=s.useState(!1),[h,d]=s.useState(!1),[i,b]=s.useState(!1),[l,x]=s.useState(!1),[w,c]=s.useState(!0),{t}=v(),u=async a=>{if(a.preventDefault(),i)return!1;const r=new FormData(a.target);if(!T.test(r.get("password"))){f("Your password has restricted characters in it. Allowed symbols are _,-,!,@,$,%,^,&,*,(,),;","error"),n(!1);return}n(!0),d(!1);const o={usePassword:l,newPassword:r.get("password")},{success:g,error:j}=await m.updateSystemPassword(o);if(g){f("Your page will refresh in a few seconds.","success"),n(!1),setTimeout(()=>{window.localStorage.removeItem(N),window.localStorage.removeItem(S),window.localStorage.removeItem(M),window.location.reload()},3e3);return}else f(`Failed to update password: ${j}`,"error"),n(!1)};return s.useEffect(()=>{async function a(){c(!0);const r=await m.isMultiUserMode(),o=await m.keys();b(r),x(o==null?void 0:o.RequiresAuth),c(!1)}a()},[]),w?e.jsx("div",{className:"h-1/2 transition-all duration-500 relative md:ml-[2px] md:mr-[8px] md:my-[16px] md:rounded-[26px] p-[18px] h-full overflow-y-scroll",children:e.jsx("div",{className:"w-full h-full flex justify-center items-center",children:e.jsx(y,{})})}):i?null:e.jsx("form",{onSubmit:u,onChange:()=>d(!0),className:"flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16",children:e.jsxs("div",{className:"w-full flex flex-col gap-y-1 pb-6 border-white light:border-theme-sidebar-border border-b-2 border-opacity-10",children:[e.jsxs("div",{className:"w-full flex flex-col gap-y-1",children:[e.jsx("div",{className:"items-center flex gap-x-4",children:e.jsx("p",{className:"text-lg leading-6 font-bold text-white",children:t("multi.password.title")})}),e.jsx("p",{className:"text-xs leading-[18px] font-base text-white text-opacity-60",children:t("multi.password.description")})]}),h&&e.jsx("div",{className:"flex justify-end",children:e.jsx(k,{onClick:()=>u(),className:"mt-3 mr-0 -mb-20 z-10",children:t(p?"common.saving":"common.save")})}),e.jsx("div",{className:"relative w-full max-h-full",children:e.jsxs("div",{className:"relative rounded-lg",children:[e.jsx("div",{className:"flex items-start justify-between px-6 py-4"}),e.jsx("div",{className:"space-y-6 flex h-full w-full",children:e.jsxs("div",{className:"w-full flex flex-col gap-y-4",children:[e.jsxs("div",{className:"",children:[e.jsx("label",{className:"mb-2.5 block font-medium text-white",children:t("multi.instance.title")}),e.jsxs("label",{className:"relative inline-flex cursor-pointer items-center",children:[e.jsx("input",{type:"checkbox",onClick:()=>x(!l),defaultChecked:l,className:"peer sr-only pointer-events-none"}),e.jsx("div",{className:"peer-disabled:opacity-50 pointer-events-none peer h-6 w-11 rounded-full bg-[#CFCFD0] after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:shadow-xl after:border-none after:bg-white after:box-shadow-md after:transition-all after:content-[''] peer-checked:bg-[#32D583] peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-transparent"})]})]}),l&&e.jsx("div",{className:"w-full flex flex-col gap-y-2 my-5",children:e.jsxs("div",{className:"mt-4 w-80",children:[e.jsx("label",{htmlFor:"password",className:"block mb-3 font-medium text-white",children:t("multi.instance.password")}),e.jsx("input",{name:"password",type:"text",className:"border-none bg-theme-settings-input-bg text-white text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5 placeholder:text-theme-settings-input-placeholder",placeholder:"Your Instance Password",minLength:8,required:!0,autoComplete:"off",defaultValue:l?"********":""})]})})]})}),e.jsx("div",{className:"flex items-center justify-between space-x-14",children:e.jsx("p",{className:"text-white text-opacity-80 light:text-theme-text text-xs rounded-lg w-96",children:t("multi.instance.description")})})]})})]})})}export{R as default};
