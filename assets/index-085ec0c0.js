import{r as l,j as e,l as w,D as v,m as N,b as g,i as S,S as u,s as f}from"../index.js";import{S as C}from"./index-af9073a4.js";import{S as k}from"./index-44bf2282.js";import{C as E}from"./index-07eec889.js";import"./Globe-1f44e45d.js";import"./index-0f62630d.js";import"./CaretRight-731d83f5.js";function L({log:t}){const[s,i]=l.useState(!1),[c,n]=l.useState(null),[a,r]=l.useState(!1);l.useEffect(()=>{function x(){var d;try{let m=JSON.parse(t.metadata);r(((d=Object.keys(m))==null?void 0:d.length)>0),n(m)}catch{}}x()},[t.metadata]);const o=()=>{t.metadata!=="{}"&&i(!s)};return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{onClick:o,className:`bg-transparent text-white text-opacity-80 text-sm font-medium ${a?"cursor-pointer hover:bg-white/5":""}`,children:[e.jsx(A,{event:t.event}),e.jsx("td",{className:"px-6 py-4 border-transparent transform transition-transform duration-200",children:t.user.username}),e.jsx("td",{className:"px-6 py-4 border-transparent transform transition-transform duration-200",children:t.occurredAt}),a&&e.jsx(e.Fragment,{children:s?e.jsxs("td",{className:"px-2 gap-x-1 flex items-center justify-center transform transition-transform duration-200 hover:scale-105",children:[e.jsx(w,{weight:"bold",size:20}),e.jsx("p",{className:"text-xs text-white/50 w-[20px]",children:"hide"})]}):e.jsxs("td",{className:"px-2 gap-x-1 flex items-center justify-center transform transition-transform duration-200 hover:scale-105",children:[e.jsx(v,{weight:"bold",size:20}),e.jsx("p",{className:"text-xs text-white/50 w-[20px]",children:"show"})]})})]}),e.jsx(M,{metadata:c,expanded:s})]})}const M=({metadata:t,expanded:s=!1})=>!t||!s?null:e.jsxs("tr",{className:"bg-theme-bg-primary",children:[e.jsx("td",{colSpan:"2",className:"px-6 py-4 font-medium text-theme-text-primary rounded-l-2xl",children:"Event Metadata"}),e.jsx("td",{colSpan:"4",className:"px-6 py-4 rounded-r-2xl",children:e.jsx("div",{className:"w-full rounded-lg bg-theme-bg-secondary p-2 text-white shadow-sm border-white/10 border bg-opacity-10",children:e.jsx("pre",{className:"overflow-scroll",children:JSON.stringify(t,null,2)})})})]}),A=({event:t})=>{let s={bg:"bg-sky-600/20",text:"text-sky-400 light:text-sky-800"};return t.includes("update")&&(s={bg:"bg-yellow-600/20",text:"text-yellow-400 light:text-yellow-800"}),(t.includes("failed_")||t.includes("deleted"))&&(s={bg:"bg-red-600/20",text:"text-red-400 light:text-red-800"}),t==="login_event"&&(s={bg:"bg-green-600/20",text:"text-green-400 light:text-green-800"}),e.jsx("td",{className:"px-6 py-4 font-medium whitespace-nowrap text-white flex items-center",children:e.jsx("span",{className:`rounded-full ${s.bg} px-2 py-0.5 text-sm font-medium ${s.text} shadow-sm`,children:t})})};function J(){const t=N(),[s,i]=l.useState(!0),[c,n]=l.useState([]),[a,r]=l.useState(Number(t.get("offset")||0)),[o,x]=l.useState(!1),{t:d}=g();l.useEffect(()=>{async function h(){const{logs:p,hasPages:j=!1}=await u.eventLogs(a);n(p),x(j),i(!1)}h()},[a]);const m=async()=>{if(!window.confirm("Are you sure you want to clear all event logs? This action is irreversible."))return;const{success:h,error:p}=await u.clearEventLogs();h?(f("Event logs cleared successfully.","success"),n([]),x(!1),r(0)):f(`Failed to clear logs: ${p}`,"error")},b=()=>{r(Math.max(a-1,0))},y=()=>{r(a+1)};return e.jsxs("div",{className:"w-screen h-screen overflow-hidden bg-theme-bg-container flex",children:[e.jsx(C,{}),e.jsx("div",{style:{height:S?"100%":"calc(100% - 32px)"},className:"relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0",children:e.jsxs("div",{className:"flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16",children:[e.jsxs("div",{className:"w-full flex flex-col gap-y-1 pb-6 border-white/10 border-b-2",children:[e.jsx("div",{className:"flex gap-x-4 items-center",children:e.jsx("p",{className:"text-lg leading-6 font-bold text-theme-text-primary",children:d("event.title")})}),e.jsx("p",{className:"text-xs leading-[18px] font-base text-theme-text-secondary mt-2",children:d("event.description")})]}),e.jsx("div",{className:"w-full justify-end flex",children:e.jsx(E,{onClick:m,className:"mt-3 mr-0 mb-4 md:-mb-14 z-10",children:d("event.clear")})}),e.jsx("div",{className:"overflow-x-auto mt-6",children:e.jsx(T,{loading:s,logs:c,offset:a,canNext:o,handleNext:y,handlePrevious:b})})]})})]})}function T({loading:t,logs:s,offset:i,canNext:c,handleNext:n,handlePrevious:a}){const{t:r}=g();return t?e.jsx(k,{height:"80vh",width:"100%",highlightColor:"var(--theme-bg-primary)",baseColor:"var(--theme-bg-secondary)",count:1,className:"w-full p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm",containerClassName:"flex w-full"}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"w-full text-sm text-left rounded-lg min-w-[640px] border-spacing-0",children:[e.jsx("thead",{className:"text-theme-text-secondary text-xs leading-[18px] font-bold uppercase border-white/10 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 rounded-tl-lg",children:r("event.table.type")}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:r("event.table.user")}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:r("event.table.occurred")}),e.jsx("th",{scope:"col",className:"px-6 py-3 rounded-tr-lg",children:" "})]})}),e.jsx("tbody",{children:!!s&&s.map(o=>e.jsx(L,{log:o},o.id))})]}),e.jsxs("div",{className:"flex w-full justify-between items-center mt-6",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 rounded-lg border border-slate-200 text-slate-200 light:text-theme-text-secondary light:border-theme-sidebar-border text-sm items-center flex gap-x-2 hover:bg-slate-200 hover:text-slate-800 disabled:invisible",disabled:i===0,children:r("common.previous")}),e.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg border border-slate-200 text-slate-200 light:text-theme-text-secondary light:border-theme-sidebar-border text-sm items-center flex gap-x-2 hover:bg-slate-200 hover:text-slate-800 disabled:invisible",disabled:!c,children:r("common.next")})]})]})}export{J as default};
