import{R as n,r as x,g as G,j as e,h as L,q as I,D as R,l as K,v as xe,b0 as be,d as Y,t as Q,p as P,L as ge,E as fe,s as F}from"../index.js";import{I as ve}from"./Brain-24e386d5.js";import{I as ye,A as T}from"./agentFlows-a4b3f736.js";import{G as we}from"./Globe-1f44e45d.js";const je=new Map([["bold",n.createElement(n.Fragment,null,n.createElement("path",{d:"M54.8,119.49A35.06,35.06,0,0,1,49.05,128a35.06,35.06,0,0,1,5.75,8.51C60,147.24,60,159.83,60,172c0,25.94,1.84,32,20,32a12,12,0,0,1,0,24c-19.14,0-32.2-6.9-38.8-20.51C36,196.76,36,184.17,36,172c0-25.94-1.84-32-20-32a12,12,0,0,1,0-24c18.16,0,20-6.06,20-32,0-12.17,0-24.76,5.2-35.49C47.8,34.9,60.86,28,80,28a12,12,0,0,1,0,24c-18.16,0-20,6.06-20,32C60,96.17,60,108.76,54.8,119.49ZM240,116c-18.16,0-20-6.06-20-32,0-12.17,0-24.76-5.2-35.49C208.2,34.9,195.14,28,176,28a12,12,0,0,0,0,24c18.16,0,20,6.06,20,32,0,12.17,0,24.76,5.2,35.49A35.06,35.06,0,0,0,207,128a35.06,35.06,0,0,0-5.75,8.51C196,147.24,196,159.83,196,172c0,25.94-1.84,32-20,32a12,12,0,0,0,0,24c19.14,0,32.2-6.9,38.8-20.51C220,196.76,220,184.17,220,172c0-25.94,1.84-32,20-32a12,12,0,0,0,0-24Z"}))],["duotone",n.createElement(n.Fragment,null,n.createElement("path",{d:"M240,128c-64,0,0,88-64,88H80c-64,0,0-88-64-88,64,0,0-88,64-88h96C240,40,176,128,240,128Z",opacity:"0.2"}),n.createElement("path",{d:"M43.18,128a29.78,29.78,0,0,1,8,10.26c4.8,9.9,4.8,22,4.8,33.74,0,24.31,1,36,24,36a8,8,0,0,1,0,16c-17.48,0-29.32-6.14-35.2-18.26-4.8-9.9-4.8-22-4.8-33.74,0-24.31-1-36-24-36a8,8,0,0,1,0-16c23,0,24-11.69,24-36,0-11.72,0-23.84,4.8-33.74C50.68,38.14,62.52,32,80,32a8,8,0,0,1,0,16C57,48,56,59.69,56,84c0,11.72,0,23.84-4.8,33.74A29.78,29.78,0,0,1,43.18,128ZM240,120c-23,0-24-11.69-24-36,0-11.72,0-23.84-4.8-33.74C205.32,38.14,193.48,32,176,32a8,8,0,0,0,0,16c23,0,24,11.69,24,36,0,11.72,0,23.84,4.8,33.74a29.78,29.78,0,0,0,8,10.26,29.78,29.78,0,0,0-8,10.26c-4.8,9.9-4.8,22-4.8,33.74,0,24.31-1,36-24,36a8,8,0,0,0,0,16c17.48,0,29.32-6.14,35.2-18.26,4.8-9.9,4.8-22,4.8-33.74,0-24.31,1-36,24-36a8,8,0,0,0,0-16Z"}))],["fill",n.createElement(n.Fragment,null,n.createElement("path",{d:"M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40ZM88,155.84c.29,14.26.41,20.16,16,20.16a8,8,0,0,1,0,16c-31.27,0-31.72-22.43-32-35.84C71.71,141.9,71.59,136,56,136a8,8,0,0,1,0-16c15.59,0,15.71-5.9,16-20.16C72.28,86.43,72.73,64,104,64a8,8,0,0,1,0,16c-15.59,0-15.71,5.9-16,20.16-.17,8.31-.41,20.09-8,27.84C87.59,135.75,87.83,147.53,88,155.84ZM200,136c-15.59,0-15.71,5.9-16,20.16-.28,13.41-.73,35.84-32,35.84a8,8,0,0,1,0-16c15.59,0,15.71-5.9,16-20.16.17-8.31.41-20.09,8-27.84-7.6-7.75-7.84-19.53-8-27.84C167.71,85.9,167.59,80,152,80a8,8,0,0,1,0-16c31.27,0,31.72,22.43,32,35.84.29,14.26.41,20.16,16,20.16a8,8,0,0,1,0,16Z"}))],["light",n.createElement(n.Fragment,null,n.createElement("path",{d:"M39.91,128a27.68,27.68,0,0,1,9.49,11.13C54,148.62,54,160.51,54,172c0,24.27,1.21,38,26,38a6,6,0,0,1,0,12c-16.88,0-27.81-5.6-33.4-17.13C42,195.38,42,183.49,42,172c0-24.27-1.21-38-26-38a6,6,0,0,1,0-12c24.79,0,26-13.73,26-38,0-11.49,0-23.38,4.6-32.87C52.19,39.6,63.12,34,80,34a6,6,0,0,1,0,12C55.21,46,54,59.73,54,84c0,11.49,0,23.38-4.6,32.87A27.68,27.68,0,0,1,39.91,128ZM240,122c-24.79,0-26-13.73-26-38,0-11.49,0-23.38-4.6-32.87C203.81,39.6,192.88,34,176,34a6,6,0,0,0,0,12c24.79,0,26,13.73,26,38,0,11.49,0,23.38,4.6,32.87A27.68,27.68,0,0,0,216.09,128a27.68,27.68,0,0,0-9.49,11.13C202,148.62,202,160.51,202,172c0,24.27-1.21,38-26,38a6,6,0,0,0,0,12c16.88,0,27.81-5.6,33.4-17.13,4.6-9.49,4.6-21.38,4.6-32.87,0-24.27,1.21-38,26-38a6,6,0,0,0,0-12Z"}))],["regular",n.createElement(n.Fragment,null,n.createElement("path",{d:"M43.18,128a29.78,29.78,0,0,1,8,10.26c4.8,9.9,4.8,22,4.8,33.74,0,24.31,1,36,24,36a8,8,0,0,1,0,16c-17.48,0-29.32-6.14-35.2-18.26-4.8-9.9-4.8-22-4.8-33.74,0-24.31-1-36-24-36a8,8,0,0,1,0-16c23,0,24-11.69,24-36,0-11.72,0-23.84,4.8-33.74C50.68,38.14,62.52,32,80,32a8,8,0,0,1,0,16C57,48,56,59.69,56,84c0,11.72,0,23.84-4.8,33.74A29.78,29.78,0,0,1,43.18,128ZM240,120c-23,0-24-11.69-24-36,0-11.72,0-23.84-4.8-33.74C205.32,38.14,193.48,32,176,32a8,8,0,0,0,0,16c23,0,24,11.69,24,36,0,11.72,0,23.84,4.8,33.74a29.78,29.78,0,0,0,8,10.26,29.78,29.78,0,0,0-8,10.26c-4.8,9.9-4.8,22-4.8,33.74,0,24.31-1,36-24,36a8,8,0,0,0,0,16c17.48,0,29.32-6.14,35.2-18.26,4.8-9.9,4.8-22,4.8-33.74,0-24.31,1-36,24-36a8,8,0,0,0,0-16Z"}))],["thin",n.createElement(n.Fragment,null,n.createElement("path",{d:"M35.89,128C52,136.23,52,155.64,52,172c0,24.8,1.35,40,28,40a4,4,0,0,1,0,8c-36,0-36-26.61-36-48,0-24.8-1.35-40-28-40a4,4,0,0,1,0-8c26.65,0,28-15.2,28-40,0-21.39,0-48,36-48a4,4,0,0,1,0,8C53.35,44,52,59.2,52,84,52,100.36,52,119.77,35.89,128ZM240,124c-26.65,0-28-15.2-28-40,0-21.39,0-48-36-48a4,4,0,0,0,0,8c26.65,0,28,15.2,28,40,0,16.36,0,35.77,16.11,44C204,136.23,204,155.64,204,172c0,24.8-1.35,40-28,40a4,4,0,0,0,0,8c36,0,36-26.61,36-48,0-24.8,1.35-40,28-40a4,4,0,0,0,0-8Z"}))]]);var Ne=Object.defineProperty,Ae=Object.defineProperties,Ce=Object.getOwnPropertyDescriptors,U=Object.getOwnPropertySymbols,Se=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable,_=(t,a,l)=>a in t?Ne(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,Fe=(t,a)=>{for(var l in a||(a={}))Se.call(a,l)&&_(t,l,a[l]);if(U)for(var l of U(a))Ee.call(a,l)&&_(t,l,a[l]);return t},ke=(t,a)=>Ae(t,Ce(a));const z=x.forwardRef((t,a)=>n.createElement(G,ke(Fe({ref:a},t),{weights:je})));z.displayName="BracketsCurly";const Ie=new Map([["bold",n.createElement(n.Fragment,null,n.createElement("path",{d:"M40.14,46.88A12,12,0,0,0,36,56V224a12,12,0,0,0,24,0V181.72c22.84-17.12,42.1-9.12,70.68,5,16.23,8,34.74,17.2,54.8,17.2,14.72,0,30.28-4.94,46.38-18.88A12,12,0,0,0,236,176V56a12,12,0,0,0-19.86-9.07c-24.71,21.41-44.53,13.31-74.82-1.68C113.19,31.27,78.17,13.94,40.14,46.88ZM212,170.26c-22.84,17.13-42.1,9.11-70.68-5C118.16,153.76,90.33,140,60,153.87V61.69c22.84-17.12,42.1-9.12,70.68,5,16.23,8,34.74,17.2,54.8,17.2A63,63,0,0,0,212,78.08Z"}))],["duotone",n.createElement(n.Fragment,null,n.createElement("path",{d:"M224,56V176c-64,55.43-112-55.43-176,0V56C112,.57,160,111.43,224,56Z",opacity:"0.2"}),n.createElement("path",{d:"M42.76,50A8,8,0,0,0,40,56V224a8,8,0,0,0,16,0V179.77c26.79-21.16,49.87-9.75,76.45,3.41,16.4,8.11,34.06,16.85,53,16.85,13.93,0,28.54-4.75,43.82-18a8,8,0,0,0,2.76-6V56A8,8,0,0,0,218.76,50c-28,24.23-51.72,12.49-79.21-1.12C111.07,34.76,78.78,18.79,42.76,50ZM216,172.25c-26.79,21.16-49.87,9.74-76.45-3.41-25-12.35-52.81-26.13-83.55-8.4V59.79c26.79-21.16,49.87-9.75,76.45,3.4,25,12.35,52.82,26.13,83.55,8.4Z"}))],["fill",n.createElement(n.Fragment,null,n.createElement("path",{d:"M232,56V176a8,8,0,0,1-2.76,6c-15.28,13.23-29.89,18-43.82,18-18.91,0-36.57-8.74-53-16.85C105.87,170,82.79,158.61,56,179.77V224a8,8,0,0,1-16,0V56a8,8,0,0,1,2.77-6h0c36-31.18,68.31-15.21,96.79-1.12C167,62.46,190.79,74.2,218.76,50A8,8,0,0,1,232,56Z"}))],["light",n.createElement(n.Fragment,null,n.createElement("path",{d:"M44.08,51.37A6,6,0,0,0,42,55.9V224a6,6,0,0,0,12,0V178.78c28.08-22.79,51.88-11,79.34,2.57,16.12,8,33.49,16.58,52,16.58,13.57,0,27.76-4.6,42.56-17.42A6,6,0,0,0,230,176V55.9a6,6,0,0,0-9.93-4.54c-29,25.12-53.28,13.09-81.41-.84C110.77,36.71,79,21.16,44.08,51.37ZM218,173.17c-28.08,22.8-51.88,11-79.34-2.58C113.4,158.08,85.09,144.07,54,164V58.72c28.08-22.8,51.88-11,79.34,2.56C158.6,73.79,186.91,87.8,218,67.91Z"}))],["regular",n.createElement(n.Fragment,null,n.createElement("path",{d:"M42.76,50A8,8,0,0,0,40,56V224a8,8,0,0,0,16,0V179.77c26.79-21.16,49.87-9.75,76.45,3.41,16.4,8.11,34.06,16.85,53,16.85,13.93,0,28.54-4.75,43.82-18a8,8,0,0,0,2.76-6V56A8,8,0,0,0,218.76,50c-28,24.23-51.72,12.49-79.21-1.12C111.07,34.76,78.78,18.79,42.76,50ZM216,172.25c-26.79,21.16-49.87,9.74-76.45-3.41-25-12.35-52.81-26.13-83.55-8.4V59.79c26.79-21.16,49.87-9.75,76.45,3.4,25,12.35,52.82,26.13,83.55,8.4Z"}))],["thin",n.createElement(n.Fragment,null,n.createElement("path",{d:"M45.39,53.06a4,4,0,0,0-1.39,3V224a4,4,0,0,0,8,0V177.87c29.41-24.39,55.08-11.69,82.23,1.73,16.5,8.17,33.33,16.5,51.13,16.5,13.14,0,26.81-4.55,41.26-17.06a4,4,0,0,0,1.38-3v-120a4,4,0,0,0-6.62-3c-30,26-56,13.07-83.61-.57C109.07,38.28,79.4,23.62,45.39,53.06ZM220,174.17c-29.41,24.4-55.08,11.7-82.23-1.73-26.82-13.27-54.5-27-85.77-4.66V57.92c29.41-24.4,55.08-11.7,82.23,1.73,26.82,13.27,54.5,27,85.77,4.66Z"}))]]);var Ve=Object.defineProperty,Oe=Object.defineProperties,Le=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertySymbols,Re=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable,$=(t,a,l)=>a in t?Ve(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,Te=(t,a)=>{for(var l in a||(a={}))Re.call(a,l)&&$(t,l,a[l]);if(W)for(var l of W(a))Me.call(a,l)&&$(t,l,a[l]);return t},Pe=(t,a)=>Oe(t,Le(a));const J=x.forwardRef((t,a)=>n.createElement(G,Pe(Te({ref:a},t),{weights:Ie})));J.displayName="Flag";function De({config:t,onConfigChange:a,onDeleteVariable:l}){const r=(u,g)=>{l(g);const v=t.variables.filter((w,N)=>N!==u);a({variables:v})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-theme-text-primary",children:"Variables"}),t.variables.map((u,g)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Variable name",value:u.name,onChange:v=>{const w=[...t.variables];w[g].name=v.target.value,a({variables:w})},className:"flex-1 border-none bg-theme-settings-input-bg text-theme-text-primary placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",autoComplete:"off",spellCheck:!1}),e.jsx("input",{type:"text",placeholder:"Initial value",value:u.value,onChange:v=>{const w=[...t.variables];w[g].value=v.target.value,a({variables:w})},className:"flex-1 border-none bg-theme-settings-input-bg text-theme-text-primary placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",autoComplete:"off",spellCheck:!1}),t.variables.length>1&&e.jsx("button",{onClick:()=>r(g,u.name),className:"p-2.5 rounded-lg border-none bg-theme-settings-input-bg text-theme-text-primary hover:text-red-500 hover:border-red-500/20 hover:bg-red-500/10 transition-colors duration-300",title:"Delete variable",children:e.jsx(L,{className:"w-4 h-4"})}),g===t.variables.length-1&&e.jsx("button",{onClick:()=>{const v=[...t.variables,{name:"",value:""}];a({variables:v})},className:"p-2.5 rounded-lg border-none bg-theme-settings-input-bg text-theme-text-primary hover:bg-theme-action-menu-item-hover transition-colors duration-300",title:"Add variable",children:e.jsx(I,{className:"w-4 h-4"})})]},g))]})}function Ze({config:t,onConfigChange:a,renderVariableSelect:l}){const r=x.useRef(null),[u,g]=x.useState(!1),v=x.useRef(null),w=(s,p,y)=>{const j=[...t.headers||[]];j[s]={...j[s],[p]:y},a({headers:j})},N=()=>{const s=[...t.headers||[],{key:"",value:""}];a({headers:s})},h=s=>{const p=[...t.headers||[]].filter((y,j)=>j!==s);a({headers:p})},o=s=>{if(!r.current)return;const p=r.current,y=p.selectionStart,j=p.selectionEnd,S=t.url,V=S.substring(0,y)+"${"+s+"}"+S.substring(j);a({url:V}),g(!1),setTimeout(()=>{const M=y+s.length+3;p.setSelectionRange(M,M),p.focus()},0)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:r,type:"text",placeholder:"https://api.example.com/endpoint",value:t.url,onChange:s=>a({url:s.target.value}),className:"flex-1 border-none bg-theme-settings-input-bg text-theme-text-primary placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",autoComplete:"off",spellCheck:!1}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{ref:v,onClick:()=>g(!u),className:"h-full px-3 rounded-lg border-none bg-theme-settings-input-bg text-theme-text-primary hover:bg-theme-action-menu-item-hover transition-colors duration-300 flex items-center gap-1",title:"Insert variable",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx(R,{className:"w-3 h-3"})]}),u&&e.jsx("div",{className:"absolute right-0 top-[calc(100%+4px)] w-48 bg-theme-settings-input-bg border-none rounded-lg shadow-lg z-10",children:l("",o,"Select variable to insert",!0)})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"Method"}),e.jsx("select",{value:t.method,onChange:s=>a({method:s.target.value}),className:"w-full border-none bg-theme-settings-input-bg text-theme-text-primary text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",children:["GET","POST","DELETE"].map(s=>e.jsx("option",{value:s,className:"bg-theme-settings-input-bg",children:s},s))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-theme-text-primary",children:"Headers"}),e.jsx("button",{onClick:N,className:"p-1.5 rounded-lg border-none bg-theme-settings-input-bg text-theme-text-primary hover:bg-theme-action-menu-item-hover transition-colors duration-300",title:"Add header",children:e.jsx(I,{className:"w-3.5 h-3.5"})})]}),e.jsx("div",{className:"space-y-2",children:(t.headers||[]).map((s,p)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Header name",value:s.key,onChange:y=>w(p,"key",y.target.value),className:"flex-1 border-none bg-theme-settings-input-bg text-theme-text-primary placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",autoComplete:"off",spellCheck:!1}),e.jsx("input",{type:"text",placeholder:"Value",value:s.value,onChange:y=>w(p,"value",y.target.value),className:"flex-1 border-none bg-theme-settings-input-bg text-theme-text-primary placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",autoComplete:"off",spellCheck:!1}),e.jsx("button",{onClick:()=>h(p),className:"p-2.5 rounded-lg border-none bg-theme-settings-input-bg text-theme-text-primary hover:text-red-500 hover:border-red-500/20 hover:bg-red-500/10 transition-colors duration-300",title:"Remove header",children:e.jsx(L,{className:"w-4 h-4"})})]},p))})]}),["POST","PUT","PATCH"].includes(t.method)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"Request Body"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("select",{value:t.bodyType||"json",onChange:s=>a({bodyType:s.target.value}),className:"w-full p-2.5 text-sm rounded-lg bg-theme-bg-primary border border-white/5 text-theme-text-primary focus:border-primary-button focus:ring-1 focus:ring-primary-button outline-none light:bg-theme-settings-input-bg light:border-black/10",children:[e.jsx("option",{value:"json",className:"bg-theme-bg-primary light:bg-theme-settings-input-bg",children:"JSON"}),e.jsx("option",{value:"text",className:"bg-theme-bg-primary light:bg-theme-settings-input-bg",children:"Raw Text"}),e.jsx("option",{value:"form",className:"bg-theme-bg-primary light:bg-theme-settings-input-bg",children:"Form Data"})]}),t.bodyType==="json"?e.jsx("textarea",{placeholder:'{"key": "value"}',value:t.body,onChange:s=>a({body:s.target.value}),className:"w-full p-2.5 text-sm rounded-lg bg-theme-bg-primary border border-white/5 text-theme-text-primary placeholder:text-theme-text-secondary/20 focus:border-primary-button focus:ring-1 focus:ring-primary-button outline-none light:bg-theme-settings-input-bg light:border-black/10 font-mono",rows:4,autoComplete:"off",spellCheck:!1}):t.bodyType==="form"?e.jsxs("div",{className:"space-y-2",children:[(t.formData||[]).map((s,p)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Key",value:s.key,onChange:y=>{const j=[...t.formData||[]];j[p]={...s,key:y.target.value},a({formData:j})},className:"flex-1 p-2.5 text-sm rounded-lg bg-theme-bg-primary border border-white/5 text-theme-text-primary placeholder:text-theme-text-secondary/20 focus:border-primary-button focus:ring-1 focus:ring-primary-button outline-none light:bg-theme-settings-input-bg light:border-black/10",autoComplete:"off",spellCheck:!1}),e.jsx("input",{type:"text",placeholder:"Value",value:s.value,onChange:y=>{const j=[...t.formData||[]];j[p]={...s,value:y.target.value},a({formData:j})},className:"flex-1 p-2.5 text-sm rounded-lg bg-theme-bg-primary border border-white/5 text-theme-text-primary placeholder:text-theme-text-secondary/20 focus:border-primary-button focus:ring-1 focus:ring-primary-button outline-none light:bg-theme-settings-input-bg light:border-black/10",autoComplete:"off",spellCheck:!1}),e.jsx("button",{onClick:()=>{const y=[...t.formData||[]].filter((j,S)=>S!==p);a({formData:y})},className:"p-2.5 rounded-lg bg-theme-bg-primary border border-white/5 text-theme-text-primary hover:text-red-500 hover:border-red-500/20 hover:bg-red-500/10 transition-colors duration-300 light:bg-theme-settings-input-bg light:border-black/10",title:"Remove field",children:e.jsx(L,{className:"w-4 h-4"})})]},p)),e.jsx("button",{onClick:()=>{const s=[...t.formData||[],{key:"",value:""}];a({formData:s})},className:"w-full p-2.5 rounded-lg border-none bg-theme-settings-input-bg text-theme-text-primary hover:bg-theme-action-menu-item-hover transition-colors duration-300 text-sm",children:"Add Form Field"})]}):e.jsx("textarea",{placeholder:"Raw request body...",value:t.body,onChange:s=>a({body:s.target.value}),className:"w-full border-none bg-theme-settings-input-bg text-theme-text-primary placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",rows:4,autoComplete:"off",spellCheck:!1})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"Store Response In"}),l(t.responseVariable,s=>a({responseVariable:s}),"Select or create variable")]})]})}function Be({config:t,onConfigChange:a,renderVariableSelect:l}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"URL"}),e.jsx("input",{type:"text",placeholder:"https://example.com",value:t.url,onChange:r=>a({url:r.target.value}),className:"w-full p-2.5 text-sm rounded-lg bg-theme-bg-primary border border-white/5 text-white placeholder:text-white/20 focus:border-primary-button focus:ring-1 focus:ring-primary-button outline-none",autoComplete:"off",spellCheck:!1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Action"}),e.jsxs("select",{value:t.action,onChange:r=>a({action:r.target.value}),className:"w-full p-2.5 text-sm rounded-lg bg-theme-bg-primary border border-white/5 text-white focus:border-primary-button focus:ring-1 focus:ring-primary-button outline-none",children:[e.jsx("option",{value:"read",className:"bg-theme-bg-primary",children:"Read Content"}),e.jsx("option",{value:"click",className:"bg-theme-bg-primary",children:"Click Element"}),e.jsx("option",{value:"type",className:"bg-theme-bg-primary",children:"Type Text"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"CSS Selector"}),e.jsx("input",{type:"text",placeholder:"#element-id or .class-name",value:t.selector,onChange:r=>a({selector:r.target.value}),className:"w-full p-2.5 text-sm rounded-lg bg-theme-bg-primary border border-white/5 text-white placeholder:text-white/20 focus:border-primary-button focus:ring-1 focus:ring-primary-button outline-none",autoComplete:"off",spellCheck:!1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Store Result In"}),l(t.resultVariable,r=>a({resultVariable:r}),"Select or create variable")]})]})}function He({config:t,onConfigChange:a,renderVariableSelect:l}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Operation"}),e.jsxs("select",{value:t.operation,onChange:r=>a({operation:r.target.value}),className:"w-full p-2.5 text-sm rounded-lg bg-theme-bg-primary border border-white/5 text-white focus:border-primary-button focus:ring-1 focus:ring-primary-button outline-none",children:[e.jsx("option",{value:"read",className:"bg-theme-bg-primary",children:"Read File"}),e.jsx("option",{value:"write",className:"bg-theme-bg-primary",children:"Write File"}),e.jsx("option",{value:"append",className:"bg-theme-bg-primary",children:"Append to File"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"File Path"}),e.jsx("input",{type:"text",placeholder:"/path/to/file",value:t.path,onChange:r=>a({path:r.target.value}),className:"w-full p-2.5 text-sm rounded-lg bg-theme-bg-primary border border-white/5 text-white placeholder:text-white/20 focus:border-primary-button focus:ring-1 focus:ring-primary-button outline-none",autoComplete:"off",spellCheck:!1})]}),t.operation!=="read"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Content"}),e.jsx("textarea",{placeholder:"File content...",value:t.content,onChange:r=>a({content:r.target.value}),className:"w-full p-2.5 text-sm rounded-lg bg-theme-bg-primary border border-white/5 text-white placeholder:text-white/20 focus:border-primary-button focus:ring-1 focus:ring-primary-button outline-none",rows:3,autoComplete:"off",spellCheck:!1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Store Result In"}),l(t.resultVariable,r=>a({resultVariable:r}),"Select or create variable")]})]})}function Ue({config:t,onConfigChange:a,renderVariableSelect:l}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Language"}),e.jsxs("select",{value:t.language,onChange:r=>a({language:r.target.value}),className:"w-full p-2.5 text-sm rounded-lg bg-theme-bg-primary border border-white/5 text-white focus:border-primary-button focus:ring-1 focus:ring-primary-button outline-none",children:[e.jsx("option",{value:"javascript",className:"bg-theme-bg-primary",children:"JavaScript"}),e.jsx("option",{value:"python",className:"bg-theme-bg-primary",children:"Python"}),e.jsx("option",{value:"shell",className:"bg-theme-bg-primary",children:"Shell"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Code"}),e.jsx("textarea",{placeholder:"Enter code...",value:t.code,onChange:r=>a({code:r.target.value}),className:"w-full p-2.5 text-sm rounded-lg bg-theme-bg-primary border border-white/5 text-white placeholder:text-white/20 focus:border-primary-button focus:ring-1 focus:ring-primary-button outline-none font-mono",rows:5,autoComplete:"off",spellCheck:!1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Store Result In"}),l(t.resultVariable,r=>a({resultVariable:r}),"Select or create variable")]})]})}function _e({config:t,onConfigChange:a,renderVariableSelect:l}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"Input Variable"}),l(t.inputVariable,r=>a({...t,inputVariable:r}),"Select input variable")]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"Instruction"}),e.jsx("textarea",{value:(t==null?void 0:t.instruction)||"",onChange:r=>a({...t,instruction:r.target.value}),className:"w-full border-none bg-theme-settings-input-bg text-theme-text-primary placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",rows:3,placeholder:"Enter instructions for the LLM..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"Result Variable"}),l(t.resultVariable,r=>a({...t,resultVariable:r}),"Select or create variable",!0)]})]})}function We(){return e.jsx("div",{className:"text-sm text-white/60",children:"This is the end of your agent flow. All steps above will be executed in sequence."})}function $e({config:t,onConfigChange:a,renderVariableSelect:l}){return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"URL to Scrape"}),e.jsx("input",{type:"url",value:(t==null?void 0:t.url)||"",onChange:r=>a({...t,url:r.target.value}),className:"w-full border-none bg-theme-settings-input-bg text-theme-text-primary placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",placeholder:"https://example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"Capture Page Content As"}),e.jsx("select",{value:t.captureAs,onChange:r=>a({captureAs:r.target.value}),className:"w-full border-none bg-theme-settings-input-bg text-theme-text-primary text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",children:[{label:"Text content only",value:"text"},{label:"Raw HTML",value:"html"},{label:"CSS Query Selector",value:"querySelector"}].map(r=>e.jsx("option",{value:r.value,className:"bg-theme-settings-input-bg",children:r.label},r.value))})]}),t.captureAs==="querySelector"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"Query Selector"}),e.jsx("p",{className:"text-xs text-theme-text-secondary mb-2",children:"Enter a valid CSS selector to scrape the content of the page."}),e.jsx("input",{value:t.querySelector,onChange:r=>a({querySelector:r.target.value}),placeholder:".article-content, #content, .main-content, etc.",className:"w-full border-none bg-theme-settings-input-bg text-theme-text-primary text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"Result Variable"}),l(t.resultVariable,r=>a({...t,resultVariable:r}),"Select or create variable",!0)]})]})}const X=x.forwardRef(({config:t,onConfigChange:a},l)=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"Flow Name"}),e.jsxs("div",{className:"flex flex-col text-xs text-theme-text-secondary mt-2 mb-3",children:[e.jsx("p",{className:"",children:"It is important to give your flow a name that an LLM can easily understand."}),e.jsx("p",{children:'"SendMessageToDiscord", "CheckStockPrice", "CheckWeather"'})]}),e.jsx("input",{id:"agent-flow-name-input",ref:l==null?void 0:l.nameRef,type:"text",placeholder:"Enter flow name",value:(t==null?void 0:t.name)||"",onChange:r=>a({...t,name:r.target.value}),className:"w-full border-none bg-theme-settings-input-bg text-theme-text-primary placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",autoComplete:"off",spellCheck:!1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-text-primary mb-2",children:"Description"}),e.jsx("div",{className:"flex flex-col text-xs text-theme-text-secondary mt-2 mb-3",children:e.jsx("p",{className:"",children:"It is equally important to give your flow a description that an LLM can easily understand. Be sure to include the purpose of the flow, the context it will be used in, and any other relevant information."})}),e.jsx("textarea",{ref:l==null?void 0:l.descriptionRef,value:(t==null?void 0:t.description)||"",onChange:r=>a({...t,description:r.target.value}),className:"w-full border-none bg-theme-settings-input-bg text-theme-text-primary placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",rows:3,placeholder:"Enter flow description"})]})]}));X.displayName="FlowInfoNode";const d={FLOW_INFO:"flowInfo",START:"start",API_CALL:"apiCall",LLM_INSTRUCTION:"llmInstruction",WEB_SCRAPING:"webScraping",FINISH:"finish"},k={[d.FLOW_INFO]:{label:"Flow Infomation",icon:e.jsx(be,{className:"w-5 h-5 text-theme-text-primary"}),description:"Basic flow information",defaultConfig:{name:"",description:""},getSummary:t=>t.name||"Untitled Flow"},[d.START]:{label:"Flow Variables",icon:e.jsx(z,{className:"w-5 h-5 text-theme-text-primary"}),description:"Configure agent variables and settings",getSummary:t=>{var l,r;const a=((r=(l=t.variables)==null?void 0:l.filter(u=>u.name))==null?void 0:r.length)||0;return`${a} variable${a!==1?"s":""} defined`}},[d.API_CALL]:{label:"API Call",icon:e.jsx(we,{className:"w-5 h-5 text-theme-text-primary"}),description:"Make an HTTP request",defaultConfig:{url:"",method:"GET",headers:[],bodyType:"json",body:"",formData:[],responseVariable:""},getSummary:t=>`${t.method||"GET"} ${t.url||"(no URL)"}`},[d.LLM_INSTRUCTION]:{label:"LLM Instruction",icon:e.jsx(ve,{className:"w-5 h-5 text-theme-text-primary"}),description:"Process data using LLM instructions",defaultConfig:{instruction:"",inputVariable:"",resultVariable:""},getSummary:t=>t.instruction||"No instruction"},[d.WEB_SCRAPING]:{label:"Web Scraping",icon:e.jsx(ye,{className:"w-5 h-5 text-theme-text-primary"}),description:"Scrape content from a webpage",defaultConfig:{url:"",captureAs:"text",querySelector:"",resultVariable:""},getSummary:t=>t.url||"No URL specified"},[d.FINISH]:{label:"Flow Complete",icon:e.jsx(J,{className:"w-4 h-4"}),description:"End of agent flow",getSummary:()=>"Flow will end here",defaultConfig:{},renderConfig:()=>null}};function qe({blocks:t,updateBlockConfig:a,removeBlock:l,toggleBlockExpansion:r,renderVariableSelect:u,onDeleteVariable:g,moveBlock:v,refs:w}){const N=h=>{const o={config:h.config,onConfigChange:s=>a(h.id,s),renderVariableSelect:u,onDeleteVariable:g};switch(h.type){case d.FLOW_INFO:return e.jsx(X,{...o,ref:w});case d.START:return e.jsx(De,{...o});case d.API_CALL:return e.jsx(Ze,{...o});case d.WEBSITE:return e.jsx(Be,{...o});case d.FILE:return e.jsx(He,{...o});case d.CODE:return e.jsx(Ue,{...o});case d.LLM_INSTRUCTION:return e.jsx(_e,{...o});case d.WEB_SCRAPING:return e.jsx($e,{...o});case d.FINISH:return e.jsx(We,{});default:return e.jsx("div",{children:"Configuration options coming soon..."})}};return e.jsxs("div",{className:"space-y-1",children:[t.map((h,o)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:`bg-theme-action-menu-bg border border-white/10 rounded-lg overflow-hidden transition-all duration-300 ${h.isExpanded?"w-full":"w-[280px] mx-auto"}`,children:[e.jsxs("div",{onClick:()=>r(h.id),className:"w-full p-4 flex items-center justify-between hover:bg-theme-action-menu-item-hover transition-colors duration-300 group cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/10 light:bg-white flex items-center justify-center",children:n.cloneElement(k[h.type].icon,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 text-left min-w-0 max-w-[115px]",children:[e.jsx("span",{className:"text-sm font-medium text-white block",children:k[h.type].label}),!h.isExpanded&&e.jsx("p",{className:"text-xs text-white/60 truncate",children:k[h.type].getSummary(h.config)})]})]}),e.jsx("div",{className:"flex items-center",children:h.id!=="start"&&h.type!==d.FINISH&&h.type!==d.FLOW_INFO&&e.jsxs("div",{className:"flex items-center gap-1",children:[o>2&&e.jsx("button",{onClick:s=>{s.stopPropagation(),v(o,o-1)},className:"p-1.5 rounded-lg bg-theme-bg-primary border border-white/5 text-white hover:bg-theme-action-menu-item-hover transition-colors duration-300","data-tooltip-id":"block-action","data-tooltip-content":"Move block up",children:e.jsx(K,{className:"w-3.5 h-3.5"})}),o<t.length-2&&e.jsx("button",{onClick:s=>{s.stopPropagation(),v(o,o+1)},className:"p-1.5 rounded-lg bg-theme-bg-primary border border-white/5 text-white hover:bg-theme-action-menu-item-hover transition-colors duration-300","data-tooltip-id":"block-action","data-tooltip-content":"Move block down",children:e.jsx(R,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:s=>{s.stopPropagation(),l(h.id)},className:"p-1.5 rounded-lg bg-theme-bg-primary border border-white/5 text-red-400 hover:bg-red-500/10 hover:border-red-500/20 transition-colors duration-300","data-tooltip-id":"block-action","data-tooltip-content":"Delete block",children:e.jsx(L,{className:"w-3.5 h-3.5"})})]})})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${h.isExpanded?"max-h-[1000px] opacity-100":"max-h-0 opacity-0"}`,children:e.jsx("div",{className:"border-t border-white/10 p-4 bg-theme-bg-secondary rounded-b-lg",children:N(h)})})]}),o<t.length-1&&e.jsx("div",{className:"flex justify-center my-1",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-white/40 light:invert",children:e.jsx("path",{d:"M12 4L12 20M12 20L6 14M12 20L18 14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]},h.id)),e.jsx(xe,{id:"block-action",place:"bottom",delayShow:300,className:"tooltip !text-xs"})]})}function Ge({showBlockMenu:t,setShowBlockMenu:a,addBlock:l}){const r=x.useRef(null);return x.useEffect(()=>{function u(g){r.current&&!r.current.contains(g.target)&&a(!1)}return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[a]),e.jsxs("div",{className:"relative mt-4 w-[280px] mx-auto pb-[50%]",ref:r,children:[e.jsxs("button",{onClick:()=>a(!t),className:"transition-all duration-300 w-full p-2.5 bg-theme-action-menu-bg hover:bg-theme-action-menu-item-hover border border-white/10 rounded-lg text-white flex items-center justify-center gap-2 text-sm font-medium",children:[e.jsx(I,{className:"w-4 h-4"}),"Add Block",e.jsx(R,{className:`w-3.5 h-3.5 transition-transform duration-300 ${t?"rotate-180":""}`})]}),t&&e.jsx("div",{className:"absolute left-0 right-0 mt-2 bg-theme-action-menu-bg border border-white/10 rounded-lg shadow-lg overflow-hidden z-10 animate-fadeUpIn",children:Object.entries(k).map(([u,g])=>u!==d.START&&u!==d.FINISH&&u!==d.FLOW_INFO&&e.jsxs("button",{onClick:()=>{l(u),a(!1)},className:"w-full p-2.5 flex items-center gap-3 hover:bg-theme-action-menu-item-hover text-white transition-colors duration-300 group",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/10 flex items-center justify-center",children:e.jsx("div",{className:"w-fit h-fit text-white",children:g.icon})}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-white/60",children:g.description})]})]},u))})]})}const Ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAWCAYAAABKbiVHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAG9SURBVHgBvVbhVcJADE59/pcRbgPqBjiBOoEwATABZQLKBMAE4AS4gWzAbYAbnIk9JA3XkoDP7728K2mS+7jk0mQQEUKY4NKHZniUVZZlS1ACY3ZwobgvF+IOMK4/Oi2CHm+gJIKyN8TNj04WHFCcgsws2LC4R79cxJmjfAkdHfeQPa9RHluIUGpGTOVRVgnTZ7a/I8eeYOggvUEp7GYNdrmw27fEXDK7rYUMpfNT2PaEjQvndZJDAySZO1ACq51S9wr1FMp0boGO+4Qp+u1ACTWZSMjjMoaqBmobxbQ5Zj7H9wVYoE3ThRjDRJ10FH7XpakloMOlZCqP8hTTasJNZCKRrVCPf7vpf5KBqt849pvqaANX4moyoWps/NpuzAX7F2SoYHEpmMqjDOBGmMnEOimYigq1VrDxdi00N4rj3mLMCpZvUitYtKFxgd8u9YlZT0Y2tmlivumx5z6SG4EWhm/TRNitG+zk9+kQlB9KSpNsTiN8IXUPcD4SjFMbUMrQn1Jz7D8/Iwfq3hPmXUj8Ewu0w1VpjFumjusSVDUQ0iNHG1zGnAuoJq+m6+ih+hKrO2w4tYFuS9xdjPvxDY+2JGgA4IyZAAAAAElFTkSuQmCC";function Ye({agentName:t,availableFlows:a=[],onNewFlow:l,onSaveFlow:r}){const{flowId:u=null}=Y(),[g,v]=x.useState(!1),w=Q(),N=x.useRef(null),h=a.filter(o=>o.uuid!==u).length>0;return x.useEffect(()=>{function o(s){N.current&&!N.current.contains(s.target)&&v(!1)}return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[]),e.jsx("div",{className:"absolute top-4 left-4 right-4",children:e.jsxs("div",{className:"flex justify-between items-center max-w-[1700px] mx-auto",children:[e.jsxs("div",{className:"flex items-center bg-theme-settings-input-bg rounded-md border border-white/10 pointer-events-auto",ref:N,children:[e.jsxs("button",{onClick:()=>w(P.settings.agentSkills()),className:"border-y-none border-l-none flex items-center gap-x-2 px-4 py-2 border-r border-white/10 hover:bg-theme-action-menu-bg transition-colors duration-300",children:[e.jsx("img",{src:Ke,alt:"logo",className:"w-[20px] light:invert"}),e.jsx("span",{className:"text-theme-text-primary text-sm uppercase tracking-widest",children:"Builder"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{disabled:!h,className:"border-none flex items-center justify-between gap-x-1 text-theme-text-primary text-sm px-4 py-2 enabled:hover:bg-theme-action-menu-bg transition-colors duration-300 min-w-[200px] max-w-[300px]",onClick:()=>{if(!t&&!h){const o=document.getElementById("agent-flow-name-input");o&&o.focus();return}v(!g)},children:[e.jsx("span",{className:`text-sm font-medium truncate ${t?"text-theme-text-primary ":"text-theme-text-secondary"}`,children:t||"Untitled Flow"}),h&&e.jsxs("div",{className:"flex flex-col ml-2 shrink-0",children:[e.jsx(K,{size:10}),e.jsx(R,{size:10})]})]}),g&&e.jsx("div",{className:"absolute top-full left-0 mt-1 w-full min-w-[200px] max-w-[350px] bg-theme-settings-input-bg border border-white/10 rounded-md shadow-lg z-50 animate-fadeUpIn",children:a.filter(o=>o.uuid!==u).map(o=>e.jsx("button",{onClick:()=>{w(P.agents.editAgent(o.uuid)),v(!1)},className:"border-none w-full text-left px-2 py-1 text-sm text-theme-text-primary hover:bg-theme-action-menu-bg transition-colors duration-300",children:e.jsx("span",{className:"block truncate",children:(o==null?void 0:o.name)||"Untitled Flow"})},(o==null?void 0:o.uuid)||Math.random()))})]})]}),e.jsxs("div",{className:"flex flex-col gap-y-1 items-end",children:[e.jsxs("div",{className:"flex items-center gap-x-[15px]",children:[e.jsxs("button",{onClick:l,className:"flex items-center gap-x-2 text-theme-text-primary text-sm font-medium px-3 py-2 rounded-lg border border-white bg-theme-settings-input-bg hover:bg-theme-action-menu-bg transition-colors duration-300",children:[e.jsx(I,{className:"w-4 h-4"}),"New Flow"]}),e.jsx("button",{onClick:r,className:"border-none bg-primary-button hover:opacity-80 text-black px-3 py-2 rounded-lg text-sm font-medium transition-all duration-300 flex items-center justify-center gap-2",children:"Save"})]}),e.jsx(ge,{to:"https://docs.anythingllm.com/agent-flows/overview",className:"text-theme-text-secondary text-sm hover:underline hover:text-cta-button flex items-center gap-x-1 w-fit float-right",children:"view documentation →"})]})]})})}const q=[{id:"flow_info",type:d.FLOW_INFO,config:{name:"",description:""},isExpanded:!0},{id:"start",type:d.START,config:{variables:[{name:"",value:""}]},isExpanded:!0},{id:"finish",type:d.FINISH,config:{},isExpanded:!1}];function et(){const{flowId:t}=Y(),{theme:a}=fe(),l=Q(),[r,u]=x.useState(""),[g,v]=x.useState(""),[w,N]=x.useState(null),[h,o]=x.useState(!0),[s,p]=x.useState(q),[y,j]=x.useState("start"),[S,V]=x.useState(!1),[M,ee]=x.useState(!1),[te,ae]=x.useState([]);x.useState(null);const D=x.useRef(null),Z=x.useRef(null);x.useEffect(()=>{B()},[]),x.useEffect(()=>{t&&re(t)},[t]),x.useEffect(()=>{var c;const i=s.find(m=>m.type===d.FLOW_INFO);u(((c=i==null?void 0:i.config)==null?void 0:c.name)||"")},[s]);const B=async()=>{try{const{success:i,error:c,flows:m}=await T.listFlows();if(!i)throw new Error(c);ae(m)}catch(i){console.error(i),F("Failed to load available flows","error",{clear:!0})}},re=async i=>{var c,m;try{const{success:b,error:O,flow:A}=await T.getFlow(i);if(!b)throw new Error(O);const C=[{id:"flow_info",type:d.FLOW_INFO,config:{name:A.config.name,description:A.config.description},isExpanded:!0},...A.config.steps.map((E,f)=>({id:f===0?"start":`block_${f}`,type:E.type,config:E.config,isExpanded:!0}))];((c=C[C.length-1])==null?void 0:c.type)!==d.FINISH&&C.push({id:"finish",type:d.FINISH,config:{},isExpanded:!1}),u(A.config.name),v(A.config.description),o((m=A.config.active)!=null?m:!0),N(A.uuid),p(C),ee(!1)}catch(b){console.error(b),F("Failed to load flow","error",{clear:!0})}},se=i=>{const c={id:`block_${s.length}`,type:i,config:{...k[i].defaultConfig},isExpanded:!0},m=[...s];m.splice(m.length-1,0,c),p(m),V(!1)},H=(i,c)=>{p(s.map(m=>m.id===i?{...m,config:{...m.config,...c}}:m))},le=i=>{i!=="start"&&(p(s.filter(c=>c.id!==i)),y===i&&j("start"))},ne=async()=>{var O,A,C,E;const i=s.find(f=>f.type===d.FLOW_INFO),c=(O=i==null?void 0:i.config)==null?void 0:O.name,m=(A=i==null?void 0:i.config)==null?void 0:A.description;if(!(c!=null&&c.trim())||!(m!=null&&m.trim())){i.isExpanded||(p(s.map(f=>f.type===d.FLOW_INFO?{...f,isExpanded:!0}:f)),await new Promise(f=>setTimeout(f,100))),c!=null&&c.trim()?m!=null&&m.trim()||(E=Z.current)==null||E.focus():(C=D.current)==null||C.focus(),F("Please provide both a name and description for your flow","error",{clear:!0});return}const b={name:c,description:m,active:h,steps:s.filter(f=>f.type!==d.FINISH&&f.type!==d.FLOW_INFO).map(f=>({type:f.type,config:f.config}))};try{const{success:f,error:pe,flow:he}=await T.saveFlow(c,b,w);if(!f)throw new Error(pe);N(he.uuid),F("Agent flow saved successfully!","success",{clear:!0}),await B()}catch(f){console.error("Save error details:",f),F("Failed to save agent flow","error",{clear:!0})}},oe=i=>{p(s.map(c=>c.id===i?{...c,isExpanded:!c.isExpanded}:c))},ie=()=>{var c,m;const i=s.find(b=>b.type===d.START);return((m=(c=i==null?void 0:i.config)==null?void 0:c.variables)==null?void 0:m.filter(b=>b.name))||[]},ce=(i,c,m="Select variable")=>e.jsxs("select",{value:i||"",onChange:b=>c(b.target.value),className:"w-full border-none bg-theme-settings-input-bg text-theme-text-primary text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none p-2.5",children:[e.jsx("option",{value:"",className:"bg-theme-bg-primary",children:m}),ie().map(b=>e.jsx("option",{value:b.name,className:"bg-theme-bg-primary",children:b.name},b.name))]}),me=i=>{s.forEach(c=>{if(c.type===d.START)return;let m=!1;const b={...c.config};b.responseVariable===i&&(b.responseVariable="",m=!0),b.resultVariable===i&&(b.resultVariable="",m=!0),m&&H(c.id,b)})},de=()=>{t&&l(P.agents.builder()),u(""),v(""),N(null),o(!0),p(q)},ue=(i,c)=>{const m=[...s],[b]=m.splice(i,1);m.splice(c,0,b),p(m)};return e.jsx("div",{style:{backgroundImage:a==="light"?"radial-gradient(rgba(0, 0, 0, 0.1) 1px, transparent 0)":"radial-gradient(rgba(255, 255, 255, 0.1) 1px, transparent 0)",backgroundSize:"15px 15px",backgroundPosition:"-7.5px -7.5px"},className:"w-full h-screen flex bg-theme-bg-primary",children:e.jsxs("div",{className:"w-full flex flex-col",children:[e.jsx(Ye,{agentName:r,availableFlows:te,onNewFlow:de,onSaveFlow:ne}),e.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:e.jsxs("div",{className:"max-w-xl mx-auto mt-14",children:[e.jsx(qe,{blocks:s,updateBlockConfig:H,removeBlock:le,toggleBlockExpansion:oe,renderVariableSelect:ce,onDeleteVariable:me,moveBlock:ue,refs:{nameRef:D,descriptionRef:Z}}),e.jsx(Ge,{showBlockMenu:S,setShowBlockMenu:V,addBlock:se})]})})]})})}export{et as default};
