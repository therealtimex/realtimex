import{r as o,j as e,I as j,u as p,s as b,S as m,h as v,p as f,k as N,b as y,i as A,M as C}from"../index.js";import{S as k}from"./index-af9073a4.js";import{S}from"./index-44bf2282.js";/* empty css                 */import{C as K}from"./PlusCircle-31c6a8d8.js";import{A as u}from"./admin-40631925.js";import{C as M}from"./index-07eec889.js";import"./Globe-1f44e45d.js";import"./index-0f62630d.js";import"./CaretRight-731d83f5.js";function I({apiKey:s}){var i;const t=o.useRef(null),[l,r]=o.useState(!1),n=async()=>{if(!window.confirm(`Are you sure you want to deactivate this api key?
After you do this it will not longer be useable.

This action is irreversible.`))return!1;t!=null&&t.current&&t.current.remove(),await(p()?u:m).deleteApiKey(s.id),b("API Key permanently deleted","info")},a=()=>{if(!s)return!1;window.navigator.clipboard.writeText(s.secret),b("API Key copied to clipboard","success"),r(!0)};return o.useEffect(()=>{function d(){if(!l)return!1;setTimeout(()=>{r(!1)},3e3)}d()},[l]),e.jsx(e.Fragment,{children:e.jsxs("tr",{ref:t,className:"bg-transparent text-white text-opacity-80 text-sm font-medium",children:[e.jsx("td",{scope:"row",className:"px-6 py-4 whitespace-nowrap",children:s.secret}),e.jsx("td",{className:"px-6 py-4 text-center",children:((i=s.createdBy)==null?void 0:i.username)||"--"}),e.jsx("td",{className:"px-6 py-4",children:s.createdAt}),e.jsxs("td",{className:"px-6 py-4 flex items-center gap-x-6",children:[e.jsx("button",{onClick:a,disabled:l,className:"border-none font-medium text-blue-300 rounded-lg hover:text-white hover:light:text-blue-500 hover:text-opacity-60 hover:underline",children:l?"Copied":"Copy API Key"}),e.jsx("button",{onClick:n,className:"border-none font-medium px-2 py-1 rounded-lg text-theme-text-primary hover:text-red-500",children:e.jsx(j,{className:"h-5 w-5"})})]})]})})}function P({closeModal:s}){const[t,l]=o.useState(null),[r,n]=o.useState(null),[a,i]=o.useState(!1),d=async x=>{n(null),x.preventDefault();const g=p()?u:m,{apiKey:h,error:w}=await g.generateApiKey();h&&l(h),n(w)},c=()=>{if(!t)return!1;window.navigator.clipboard.writeText(t.secret),i(!0)};return o.useEffect(()=>{function x(){if(!a)return!1;setTimeout(()=>{i(!1)},3e3)}x()},[a]),e.jsx("div",{className:"fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"relative w-full max-w-2xl bg-theme-bg-secondary rounded-lg shadow border-2 border-theme-modal-border",children:[e.jsxs("div",{className:"relative p-6 border-b rounded-t border-theme-modal-border",children:[e.jsx("div",{className:"w-full flex gap-x-2 items-center",children:e.jsx("h3",{className:"text-xl font-semibold text-white overflow-hidden overflow-ellipsis whitespace-nowrap",children:"Create new API key"})}),e.jsx("button",{onClick:s,type:"button",className:"absolute top-4 right-4 transition-all duration-300 bg-transparent rounded-lg text-sm p-1 inline-flex items-center hover:bg-theme-modal-border hover:border-theme-modal-border hover:border-opacity-50 border-transparent border",children:e.jsx(v,{size:24,weight:"bold",className:"text-white"})})]}),e.jsx("div",{className:"px-7 py-6",children:e.jsxs("form",{onSubmit:d,children:[e.jsxs("div",{className:"space-y-6 max-h-[60vh] overflow-y-auto pr-2",children:[r&&e.jsxs("p",{className:"text-red-400 text-sm",children:["Error: ",r]}),t&&e.jsx("input",{type:"text",defaultValue:`${t.secret}`,disabled:!0,className:"border-none bg-theme-settings-input-bg w-full text-white placeholder:text-theme-settings-input-placeholder text-sm rounded-lg focus:outline-primary-button active:outline-primary-button outline-none block w-full p-2.5"}),e.jsx("p",{className:"text-white text-opacity-60 text-xs md:text-sm",children:"Once created the API key can be used to programmatically access and configure this AnythingLLM instance."}),e.jsx("a",{href:f.apiDocs(),target:"_blank",rel:"noreferrer",className:"text-blue-400 hover:underline",children:"Read the API documentation →"})]}),e.jsx("div",{className:"flex justify-between items-center mt-6 pt-6 border-t border-theme-modal-border",children:t?e.jsx("button",{onClick:c,type:"button",disabled:a,className:"w-full transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm",children:a?"Copied API key":"Copy API key"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:s,type:"button",className:"transition-all duration-300 text-white hover:bg-zinc-700 px-4 py-2 rounded-lg text-sm",children:"Cancel"}),e.jsx("button",{type:"submit",className:"transition-all duration-300 bg-white text-black hover:opacity-60 px-4 py-2 rounded-lg text-sm",children:"Create API key"})]})})]})})]})})}function $(){const{isOpen:s,openModal:t,closeModal:l}=N(),{t:r}=y();return e.jsxs("div",{className:"w-screen h-screen overflow-hidden bg-theme-bg-container flex",children:[e.jsx(k,{}),e.jsxs("div",{style:{height:A?"100%":"calc(100% - 32px)"},className:"relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[16px] bg-theme-bg-secondary w-full h-full overflow-y-scroll p-4 md:p-0",children:[e.jsxs("div",{className:"flex flex-col w-full px-1 md:pl-6 md:pr-[50px] md:py-6 py-16",children:[e.jsxs("div",{className:"w-full flex flex-col gap-y-1 pb-6 border-white/10 border-b-2",children:[e.jsx("div",{className:"items-center flex gap-x-4",children:e.jsx("p",{className:"text-lg leading-6 font-bold text-theme-text-primary",children:r("api.title")})}),e.jsx("p",{className:"text-xs leading-[18px] font-base text-theme-text-secondary mt-2",children:r("api.description")}),e.jsxs("a",{href:f.apiDocs(),target:"_blank",rel:"noreferrer",className:"text-xs leading-[18px] font-base text-blue-300 light:text-blue-500 hover:underline mt-1",children:[r("api.link")," →"]})]}),e.jsx("div",{className:"w-full justify-end flex",children:e.jsxs(M,{onClick:t,className:"mt-3 mr-0 mb-4 md:-mb-14 z-10",children:[e.jsx(K,{className:"h-4 w-4",weight:"bold"})," ",r("api.generate")]})}),e.jsx("div",{className:"overflow-x-auto mt-6",children:e.jsx(E,{})})]}),e.jsx(C,{isOpen:s,children:e.jsx(P,{closeModal:l})})]})]})}function E(){const[s,t]=o.useState(!0),[l,r]=o.useState([]),{t:n}=y();return o.useEffect(()=>{async function a(){const d=p()?u:m,{apiKeys:c}=await d.getApiKeys();r(c),t(!1)}a()},[]),s?e.jsx(S,{height:"80vh",width:"100%",highlightColor:"var(--theme-bg-primary)",baseColor:"var(--theme-bg-secondary)",count:1,className:"w-full p-4 rounded-b-2xl rounded-tr-2xl rounded-tl-sm",containerClassName:"flex w-full"}):e.jsxs("table",{className:"w-full text-sm text-left rounded-lg min-w-[640px] border-spacing-0",children:[e.jsx("thead",{className:"text-theme-text-secondary text-xs leading-[18px] font-bold uppercase border-white/10 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 rounded-tl-lg",children:n("api.table.key")}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:n("api.table.by")}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:n("api.table.created")}),e.jsx("th",{scope:"col",className:"px-6 py-3 rounded-tr-lg",children:" "})]})}),e.jsx("tbody",{children:l.map(a=>e.jsx(I,{apiKey:a},a.id))})]})}export{$ as default};
